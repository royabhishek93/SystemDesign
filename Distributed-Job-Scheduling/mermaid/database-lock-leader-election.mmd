graph TD
    A["Pod 1"] --> B["SELECT...FOR<br/>UPDATE"]
    C["Pod 2"] --> B
    D["Pod 3"] --> B
    
    B --> E["PostgreSQL<br/>leader_lock Table"]
    
    E --> F["Row Lock<br/>Pod 1 Holds"]
    
    G["Pod 2, Pod 3<br/>Wait for Lock"] --> F
    
    F --> H["Pod 1: Leader<br/>Executes Job<br/>Updates last_updated"]
    
    H --> I["Release Lock<br/>COMMIT"]
    
    I --> J["Pod 2 or 3<br/>Acquires Lock<br/>Now Leader"]
    
    style A fill:#e1f5ff
    style C fill:#e1f5ff
    style D fill:#e1f5ff
    style E fill:#ffccbc
    style F fill:#c8e6c9
    style H fill:#fff9c4
    style J fill:#c8e6c9
